<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SOCKS5 转换工具</title>
<style>
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        margin: 0;
        padding: 40px 20px;
        color: #333;
        min-height: 100vh;
        background-attachment: fixed;
    }
    body::before {
        content: '';
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background-image: radial-gradient(rgba(255,255,255,0.2) 1px, transparent 1px);
        background-size: 50px 50px;
        pointer-events: none;
    }
    h2 {
        text-align: center;
        color: #222;
        font-size: 28px;
        text-shadow: 1px 1px 2px rgba(255,255,255,0.7);
        margin-bottom: 30px;
    }
    .tabs {
        display: flex;
        justify-content: center;
        margin-bottom: 25px;
    }
    .tab {
        padding: 12px 30px;
        cursor: pointer;
        background: rgba(255,255,255,0.8);
        margin-right: 5px;
        border-radius: 8px 8px 0 0;
        font-weight: 500;
        transition: all 0.3s ease;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        backdrop-filter: blur(5px);
    }
    .tab:hover { 
        background: rgba(255,255,255,0.95); 
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .tab.active { 
        background: #fff; 
        font-weight: bold; 
        border-bottom: 2px solid #fff; 
        box-shadow: 0 4px 15px rgba(0,0,0,0.15);
    }
    .tab-content {
        display: none;
        background: rgba(255,255,255,0.95);
        padding: 30px;
        border-radius: 0 8px 8px 8px;
        box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        max-width: 800px;
        margin: 0 auto 40px auto;
        transform: scale(0.95);
        opacity: 0;
        transition: all 0.3s ease;
        backdrop-filter: blur(5px);
    }
    .tab-content.active {
        display: block;
        transform: scale(1);
        opacity: 1;
    }
    input[type="text"], textarea {
        width: 100%;
        font-size: 15px;
        padding: 14px;
        margin: 12px 0 18px 0;
        box-sizing: border-box;
        border: 1px solid #ccc;
        border-radius: 8px;
        transition: all 0.3s ease;
        background: rgba(250,250,250,0.8);
        cursor: text;
        backdrop-filter: blur(5px);
    }
    input[type="text"]:focus, textarea:focus {
        border-color: #4a90e2;
        box-shadow: 0 0 15px rgba(74,144,226,0.4);
        outline: none;
        background: rgba(255,255,255,0.95);
    }
    .hint { color: #666; font-size: 14px; margin-bottom: 12px; }
    .btn {
        padding: 12px 20px;
        font-size: 15px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        margin-right: 10px;
        transition: all 0.15s ease;
        color: #fff;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        user-select: none;
    }
    .btn:active {
        transform: scale(0.95);
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .btn-primary { background: linear-gradient(45deg, #4a90e2, #357ABD); }
    .btn-primary:hover { background: linear-gradient(45deg, #357ABD, #4a90e2); }
    .btn-secondary { background: linear-gradient(45deg, #7f8c8d, #566573); }
    .btn-secondary:hover { background: linear-gradient(45deg, #566573, #7f8c8d); }
    .btn-danger { background: linear-gradient(45deg, #e74c3c, #c0392b); }
    .btn-danger:hover { background: linear-gradient(45deg, #c0392b, #e74c3c); }
    .status {
        font-size: 14px;
        color: #e74c3c;
        margin-bottom: 10px;
    }
    ul { font-size: 14px; line-height: 1.8; }
</style>
</head>
<body>

<h2>SOCKS5 转换工具</h2>

<div class="tabs">
    <div class="tab active" onclick="showTab('singleTab', this)">单链接转换</div>
    <div class="tab" onclick="showTab('batchTab', this)">批量转换</div>
    <div class="tab" onclick="showTab('guideTab', this)">使用说明</div>
</div>

<!-- 单链接转换 -->
<div id="singleTab" class="tab-content active">
    <div class="hint">输入一条 SOCKS5 链接</div>
    <input type="text" id="singleInput" placeholder="socks5://user:pass@host:port#remark">
    <div class="status" id="singleStatus"></div>
    <div style="margin-bottom: 15px;">
        <button class="btn btn-primary" onclick="convertSingle()">转换</button>
        <button class="btn btn-secondary" onclick="copySingle()">复制结果</button>
        <button class="btn btn-danger" onclick="clearSingle()">清空</button>
    </div>
    <div class="hint">转换结果</div>
    <textarea id="singleOutput" placeholder="转换结果"></textarea>
</div>

<!-- 批量转换 -->
<div id="batchTab" class="tab-content">
    <div class="hint">每行一条 SOCKS5 链接</div>
    <textarea id="batchInput" placeholder="socks5://user:pass@host:port#remark"></textarea>
    <div class="status" id="batchStatus"></div>
    <div style="margin-bottom: 15px;">
        <button class="btn btn-primary" onclick="convertBatch()">批量转换</button>
        <button class="btn btn-secondary" onclick="copyBatch()">复制结果</button>
        <button class="btn btn-danger" onclick="clearBatch()">清空</button>
    </div>
    <div class="hint">转换结果</div>
    <textarea id="batchOutput" placeholder="转换结果"></textarea>
</div>

<!-- 使用说明 -->
<div id="guideTab" class="tab-content">
    <ul>
        <li><strong>单链接转换：</strong>输入一条 <code>socks5://user:pass@host:port#remark</code>，点击“转换”，然后可选择“复制结果”。</li>
        <li><strong>批量转换：</strong>每行输入一条 SOCKS5 链接，点击“批量转换”，可选择“复制结果”。</li>
        <li><strong>输出格式：</strong>host:port:username:password</li>
        <li>转换结果会手动复制到剪贴板。</li>
        <li>点击“清空”可清空输入和输出。</li>
        <li>格式错误或不完整的链接会自动忽略，并在状态提示有效/无效行数。</li>
    </ul>
</div>

<script>
function showTab(tabId, el) {
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.getElementById(tabId).classList.add('active');
    el.classList.add('active');
}

function convertLink(line) {
    const cleaned = line.trim().replace(/^socks5:\/\//i, "").split("#")[0];
    if (!cleaned.includes("@")) return null;
    const [userInfo, hostInfo] = cleaned.split("@");
    if (!userInfo || !hostInfo) return null;
    const [username, password] = userInfo.split(":");
    const [host, port] = hostInfo.split(":");
    if (username && password && host && port) return `${host}:${port}:${username}:${password}`;
    return null;
}

function showStatus(el, msg, color="#e74c3c") {
    el.textContent = msg;
    el.style.color = color;
}

async function copyText(el, statusEl) {
    if (!el.value) return showStatus(statusEl, "没有内容可以复制！");
    try {
        await navigator.clipboard.writeText(el.value);
        showStatus(statusEl, "已复制到剪贴板！", "#27ae60");
    } catch {
        showStatus(statusEl, "复制失败！");
    }
}

// 单链接
function convertSingle() {
    const line = document.getElementById("singleInput").value.trim();
    const outputEl = document.getElementById("singleOutput");
    const statusEl = document.getElementById("singleStatus");
    if (!line) return showStatus(statusEl, "请输入 SOCKS5 链接！");
    const result = convertLink(line);
    if (!result) return showStatus(statusEl, "链接格式错误！");
    outputEl.value = result;
    outputEl.classList.add('active');
    showStatus(statusEl, "转换成功！", "#27ae60");
}

function copySingle() {
    copyText(document.getElementById("singleOutput"), document.getElementById("singleStatus"));
}

function clearSingle() {
    document.getElementById("singleInput").value = "";
    document.getElementById("singleOutput").value = "";
    document.getElementById("singleStatus").textContent = "";
}

// 批量
function convertBatch() {
    const input = document.getElementById("batchInput").value.trim();
    const outputEl = document.getElementById("batchOutput");
    const statusEl = document.getElementById("batchStatus");
    if (!input) return showStatus(statusEl, "请输入 SOCKS5 链接！");
    const lines = input.split(/\r?\n/);
    const results = [];
    let invalidCount = 0;
    lines.forEach((line, index) => {
        const converted = convertLink(line);
        if (converted) results.push(converted);
        else if (line.trim()) invalidCount++;
    });
    if (results.length === 0) return showStatus(statusEl, "没有有效的 SOCKS5 链接！");
    outputEl.value = results.join("\n");
    showStatus(statusEl, `转换完成！有效: ${results.length}, 无效: ${invalidCount}`, "#27ae60");
}

function copyBatch() {
    copyText(document.getElementById("batchOutput"), document.getElementById("batchStatus"));
}

function clearBatch() {
    document.getElementById("batchInput").value = "";
    document.getElementById("batchOutput").value = "";
    document.getElementById("batchStatus").textContent = "";
}
</script>

</body>
</html>
